{"ast":null,"code":"var _s = $RefreshSig$();\nimport React, { useState, useRef } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { fetchCarDrive } from 'CONSTANTS/Axios';\nimport { deleteCar, setSelectedCar } from 'store/modules/listReducer';\nimport styles from './GarageTableRow.module.scss';\nfunction UseGarageTableRow(carData) {\n  _s();\n  const dispatch = useDispatch();\n  const {\n    id\n  } = carData;\n  const selectedCar = useSelector(store => store.list.selectedCar);\n  const [speed, setSpeed] = useState(0);\n  const [raceStatus, setRaceStatus] = useState('stopped');\n  const animationStyle = {\n    animation: `${styles.moveToEnd} ${speed}s linear 4.2s forwards`\n  };\n  const timerRef = useRef(null);\n  const clearTimer = () => {\n    if (timerRef.current) {\n      clearTimeout(timerRef.current);\n      timerRef.current = null;\n    }\n  };\n  const handleStart = () => {\n    clearTimer();\n    dispatch(setSelectedCar(undefined));\n    setRaceStatus('started');\n    fetchCarDrive(id, 'started').then(response => {\n      if (response !== null && response !== void 0 && response.isFailed) setRaceStatus('stopped');else {\n        const speedNewValue = response.distance / (response.velocity * 1500);\n        setSpeed(speedNewValue);\n        timer = setTimeout(() => {\n          setRaceStatus('finished');\n          timer = null;\n        }, (speedNewValue + 4.2) * 1000);\n      }\n    });\n  };\n  const handleStop = () => {\n    fetchCarDrive(id, 'stopped');\n    setRaceStatus('stopped');\n    clearTimer();\n  };\n  const toggleSelect = () => dispatch(setSelectedCar((selectedCar === null || selectedCar === void 0 ? void 0 : selectedCar.id) == id ? undefined : carData));\n  const handleDelete = () => dispatch(deleteCar(id));\n  return {\n    handleStart,\n    handleStop,\n    toggleSelect,\n    handleDelete,\n    raceStatus,\n    animationStyle\n  };\n}\n_s(UseGarageTableRow, \"wfJSu71J/b7ZZsgAHu57EeTKhb0=\", false, function () {\n  return [useDispatch, useSelector];\n});\n_c = UseGarageTableRow;\nexport default UseGarageTableRow;\nvar _c;\n$RefreshReg$(_c, \"UseGarageTableRow\");","map":{"version":3,"names":["React","useState","useRef","useDispatch","useSelector","fetchCarDrive","deleteCar","setSelectedCar","styles","UseGarageTableRow","carData","_s","dispatch","id","selectedCar","store","list","speed","setSpeed","raceStatus","setRaceStatus","animationStyle","animation","moveToEnd","timerRef","clearTimer","current","clearTimeout","handleStart","undefined","then","response","isFailed","speedNewValue","distance","velocity","timer","setTimeout","handleStop","toggleSelect","handleDelete","_c","$RefreshReg$"],"sources":["C:/Users/Admin/Documents/GitHub/Async-Race/src/components/commons/GarageTableRow/UseGarageTableRow.js"],"sourcesContent":["import React, { useState, useRef } from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\n\r\nimport { fetchCarDrive } from 'CONSTANTS/Axios';\r\nimport { deleteCar, setSelectedCar } from 'store/modules/listReducer';\r\n\r\nimport styles from './GarageTableRow.module.scss';\r\n\r\nfunction UseGarageTableRow( carData ) {\r\n   const dispatch = useDispatch();\r\n   const { id } = carData;\r\n   const selectedCar = useSelector( store => store.list.selectedCar );\r\n   const [ speed, setSpeed ] = useState( 0 );\r\n   const [ raceStatus, setRaceStatus ] = useState( 'stopped' );\r\n   const animationStyle = { animation: `${ styles.moveToEnd } ${ speed }s linear 4.2s forwards` };\r\n   const timerRef = useRef(null);\r\n\r\n   const clearTimer = () => {\r\n      if ( timerRef.current ) {\r\n         clearTimeout( timerRef.current );\r\n         timerRef.current = null;\r\n      }\r\n   };\r\n\r\n   const handleStart = () => {\r\n      clearTimer();\r\n      dispatch( setSelectedCar( undefined ) );\r\n      setRaceStatus( 'started' );\r\n      fetchCarDrive( id, 'started' )\r\n      .then( response => {\r\n         if ( response?.isFailed ) setRaceStatus( 'stopped' );\r\n         else {\r\n            const speedNewValue = response.distance / ( response.velocity * 1500 );\r\n            setSpeed( speedNewValue );\r\n            timer = setTimeout( () => {\r\n               setRaceStatus( 'finished' );\r\n               timer = null;\r\n            }, ( speedNewValue + 4.2 ) * 1000 );\r\n         }\r\n      });\r\n   };\r\n   const handleStop = () => {\r\n      fetchCarDrive( id, 'stopped' );\r\n      setRaceStatus( 'stopped' );\r\n      clearTimer();\r\n   };\r\n   const toggleSelect = () => dispatch( setSelectedCar( selectedCar?.id == id ? undefined : carData ) );\r\n   const handleDelete = () => dispatch( deleteCar( id ) );\r\n   \r\n   return {\r\n      handleStart,\r\n      handleStop,\r\n      toggleSelect,\r\n      handleDelete,\r\n      raceStatus,\r\n      animationStyle,\r\n   }\r\n}\r\n\r\nexport default UseGarageTableRow;"],"mappings":";AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,MAAM,QAAQ,OAAO;AAC/C,SAASC,WAAW,EAAEC,WAAW,QAAQ,aAAa;AAEtD,SAASC,aAAa,QAAQ,iBAAiB;AAC/C,SAASC,SAAS,EAAEC,cAAc,QAAQ,2BAA2B;AAErE,OAAOC,MAAM,MAAM,8BAA8B;AAEjD,SAASC,iBAAiBA,CAAEC,OAAO,EAAG;EAAAC,EAAA;EACnC,MAAMC,QAAQ,GAAGT,WAAW,CAAC,CAAC;EAC9B,MAAM;IAAEU;EAAG,CAAC,GAAGH,OAAO;EACtB,MAAMI,WAAW,GAAGV,WAAW,CAAEW,KAAK,IAAIA,KAAK,CAACC,IAAI,CAACF,WAAY,CAAC;EAClE,MAAM,CAAEG,KAAK,EAAEC,QAAQ,CAAE,GAAGjB,QAAQ,CAAE,CAAE,CAAC;EACzC,MAAM,CAAEkB,UAAU,EAAEC,aAAa,CAAE,GAAGnB,QAAQ,CAAE,SAAU,CAAC;EAC3D,MAAMoB,cAAc,GAAG;IAAEC,SAAS,EAAE,GAAId,MAAM,CAACe,SAAS,IAAMN,KAAK;EAA0B,CAAC;EAC9F,MAAMO,QAAQ,GAAGtB,MAAM,CAAC,IAAI,CAAC;EAE7B,MAAMuB,UAAU,GAAGA,CAAA,KAAM;IACtB,IAAKD,QAAQ,CAACE,OAAO,EAAG;MACrBC,YAAY,CAAEH,QAAQ,CAACE,OAAQ,CAAC;MAChCF,QAAQ,CAACE,OAAO,GAAG,IAAI;IAC1B;EACH,CAAC;EAED,MAAME,WAAW,GAAGA,CAAA,KAAM;IACvBH,UAAU,CAAC,CAAC;IACZb,QAAQ,CAAEL,cAAc,CAAEsB,SAAU,CAAE,CAAC;IACvCT,aAAa,CAAE,SAAU,CAAC;IAC1Bf,aAAa,CAAEQ,EAAE,EAAE,SAAU,CAAC,CAC7BiB,IAAI,CAAEC,QAAQ,IAAI;MAChB,IAAKA,QAAQ,aAARA,QAAQ,eAARA,QAAQ,CAAEC,QAAQ,EAAGZ,aAAa,CAAE,SAAU,CAAC,CAAC,KAChD;QACF,MAAMa,aAAa,GAAGF,QAAQ,CAACG,QAAQ,IAAKH,QAAQ,CAACI,QAAQ,GAAG,IAAI,CAAE;QACtEjB,QAAQ,CAAEe,aAAc,CAAC;QACzBG,KAAK,GAAGC,UAAU,CAAE,MAAM;UACvBjB,aAAa,CAAE,UAAW,CAAC;UAC3BgB,KAAK,GAAG,IAAI;QACf,CAAC,EAAE,CAAEH,aAAa,GAAG,GAAG,IAAK,IAAK,CAAC;MACtC;IACH,CAAC,CAAC;EACL,CAAC;EACD,MAAMK,UAAU,GAAGA,CAAA,KAAM;IACtBjC,aAAa,CAAEQ,EAAE,EAAE,SAAU,CAAC;IAC9BO,aAAa,CAAE,SAAU,CAAC;IAC1BK,UAAU,CAAC,CAAC;EACf,CAAC;EACD,MAAMc,YAAY,GAAGA,CAAA,KAAM3B,QAAQ,CAAEL,cAAc,CAAE,CAAAO,WAAW,aAAXA,WAAW,uBAAXA,WAAW,CAAED,EAAE,KAAIA,EAAE,GAAGgB,SAAS,GAAGnB,OAAQ,CAAE,CAAC;EACpG,MAAM8B,YAAY,GAAGA,CAAA,KAAM5B,QAAQ,CAAEN,SAAS,CAAEO,EAAG,CAAE,CAAC;EAEtD,OAAO;IACJe,WAAW;IACXU,UAAU;IACVC,YAAY;IACZC,YAAY;IACZrB,UAAU;IACVE;EACH,CAAC;AACJ;AAACV,EAAA,CAjDQF,iBAAiB;EAAA,QACNN,WAAW,EAERC,WAAW;AAAA;AAAAqC,EAAA,GAHzBhC,iBAAiB;AAmD1B,eAAeA,iBAAiB;AAAC,IAAAgC,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}